/*
 * Copyright 2015 Microchip Technology, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 *
 */

/dts-v1/;

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/pinctrl/pic32mzda.h>

#include "pic32mzda.dtsi"

/ {
	compatible = "microchip,pic32mzda-sk", "microchip,pic32mzda";
	model = "Microchip PIC32MZDA Starter Kit";

        memory {
                device_type = "memory";
                reg = <0x08000000 0x08000000>;
        };

	chosen {
                bootargs = "earlyprintk=ttyS1,115200n8r console=ttyS1,115200n8";
        };

	leds {
                compatible = "gpio-leds";
                pinctrl-names = "default";
                pinctrl-0 = <&user_leds_s0>;

                led@1 {
                        label = "pic32mzda_sk:red:heartbeat";
                        gpios = <&pioH 0 GPIO_ACTIVE_HIGH>;
                        linux,default-trigger = "heartbeat";
                };

                led@2 {
                        label = "pic32mzda_sk:yellow:led2";
                        gpios = <&pioH 1 GPIO_ACTIVE_HIGH>;
                        default-state = "on";
                };

                led@3 {
                        label = "pic32mzda_sk:green:led3";
                        gpios = <&pioH 2 GPIO_ACTIVE_HIGH>;
                        default-state = "on";
                };

	};

	keys0 {
                compatible = "gpio-keys-polled";
                pinctrl-0 = <&user_buttons_s0>;
                pinctrl-names = "default";

		#address-cells = <1>;
                #size-cells = <0>;
                poll-interval = <300>;

                button@sw1 {
                        label = "GPIO Power";
                        linux,code = <116>;
                        gpios = <&pioB 12 0>;
                };

                button@sw2 {
                        label = "Tab";
                        linux,code = <15>;
                        gpios = <&pioB 13 0>;
                };

                button@sw3 {
                        label = "Enter";
                        linux,code = <28>;
                        gpios = <&pioB 14 0>;
                };
        };
};

&eth0 {
	mac-address = [00 00 00 00 00 00];
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_eth0>;
	reset-gpio = <&pioJ 15 0>;
	status = "okay";
};

&usart2 {
        pinctrl-names = "default";
        pinctrl-0 = <&pinctrl_uart2>;
        status = "okay";
};

&usb1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usb1_vbus>;
	vbus_on-gpios = <&pioB 5 0>;
	status = "okay";
};

&usb1_phy {
	status = "okay";
};

&sdhci {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_sdhc1>;
	status = "okay";
};

&pic32_pinctrl {

	usb1 {
		pinctrl_usb1_vbus: usb1_vbus-0 {
			pic32,single-pins = <PORT_B 5 PIC32_PIN_CONF_DG_OUT>;
		};
	};

	sdhc1 {
		pinctrl_sdhc1: sdhc1_pins0 {
			pic32,single-pins =
			<PORT_A 6 PIC32_PIN_CONF_DG>,     /* SDCLK */
			<PORT_D 4 PIC32_PIN_CONF_DG>,     /* SDCMD */
			<PORT_G 13 PIC32_PIN_CONF_DG>,    /* SDDATA0 */
			<PORT_G 12 PIC32_PIN_CONF_DG>,    /* SDDATA1 */
			<PORT_G 14 PIC32_PIN_CONF_DG>,	  /* SDDATA2 */
			<PORT_A 7 PIC32_PIN_CONF_DG>,	  /* SDDATA3 */
			<PORT_A 0 PIC32_PIN_CONF_DG>;	  /* SDCD */
		};
	};

	eth0 {
		pinctrl_eth0: eth0_0 {
			pic32,single-pins = <PORT_D 11 PIC32_PIN_CONF_DG>,
			<PORT_D 6 PIC32_PIN_CONF_DG>,
			<PORT_H 13 PIC32_PIN_CONF_DG>,
			<PORT_H 8 PIC32_PIN_CONF_DG>,
			<PORT_H 8 PIC32_PIN_CONF_PD>,
			<PORT_H 5 PIC32_PIN_CONF_DG>,
			<PORT_H 5 PIC32_PIN_CONF_PD>,
			<PORT_F 3 PIC32_PIN_CONF_DG>,
			<PORT_J 11 PIC32_PIN_CONF_DG>,
			<PORT_J 9 PIC32_PIN_CONF_DG>,
			<PORT_J 8 PIC32_PIN_CONF_DG>,
			<PORT_J 1 PIC32_PIN_CONF_DG>,
			<PORT_B 11 PIC32_PIN_CONF_DG_IN>,
			<PORT_J 15 PIC32_PIN_CONF_DG_OUT>;
		};
	};

	leds {

		user_leds_s0: user_leds_s0 {
			pic32,single-pins = <
                        PORT_H 0 PIC32_PIN_CONF_DG_OUT
                        PORT_H 1 PIC32_PIN_CONF_DG_OUT
			PORT_H 2 PIC32_PIN_CONF_DG_OUT>;
		};
	};

	buttons0 {
		user_buttons_s0: user_buttons_s0 {
			pic32,single-pins = <PORT_B 12 PIC32_PIN_CONF_PU_IN
			PORT_B 13 PIC32_PIN_CONF_PU_IN
			PORT_B 14 PIC32_PIN_CONF_PU_IN>;
		};
	};

        uart2 {
                pinctrl_uart2: uart2-0 {
                        pic32,pins =
                        <PIC32_RP_OUT_RPG9 PIC32_PP_OUT_U2TX PIC32_PIN_CONF_DG_OUT
                        PIC32_RP_IN_RPB0 PIC32_PP_IN_U2RX PIC32_PIN_CONF_DG_IN>;
                };
        };
};
